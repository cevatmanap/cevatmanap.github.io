<h1 id="gf2m-inversion">GF(2^m) Inversion</h1>

<h2 id="general-idea-for-implementing-gfq2-operations-on-gfq">General Idea for Implementing GF(q^2) Operations on GF(q)</h2>
<p>Polinomial defining GF(q^2) over GF(q):</p>

<p>p(x) = x^2 + p1*x + p0</p>

<p>p1,p0 in GF(q)</p>

<h2 id="inversion-on-gfq2">Inversion on GF(q^2)</h2>
<p>A, B in GF(q^2), A = a1 * x + a0, B = b1 * x + b0,</p>

<p>a1,a0,b1,b0 in GF(q),</p>

<p>B satisfies B = A^-1</p>

<p>Calculate b1, b0 as:</p>

<p>t = (a1^2 * p0 + a1 * a0 * p1 + a0^2)^-1</p>

<p>b1 = t * a1</p>

<p>b0 = t * (a1 * p1 + a0)</p>

<p>all operations for calculating t,b1,b0 are on GF(q)</p>

<h2 id="multiplication-on-gfq2">Multiplication on GF(q^2)</h2>
<p>A, B, C in GF(q^2), A = a1 * x + a0, B = b1 * x + b0, C = c1 * x + c0,</p>

<p>a1,a0,b1,b0,c1,c0 in GF(q),</p>

<p>C satisfies C = A * B</p>

<p>Calculate c1, c0 as:</p>

<p>c1 = a1 * b0 + a0 * b1 + a1 * b1 * p1</p>

<p>c0 = a0 * b0 + a1 * b1 * p0</p>

<h2 id="multiplication-on-gfq2-1">Multiplication on GF(q^2)</h2>
<p>A, B in GF(q^2), A = a1 * x + a0, B = b1 * x + b0,</p>

<p>a1,a0,b1,b0 in GF(q),</p>

<p>B satisfies B = A * A</p>

<p>Calculate b1, b0 as:</p>

<p>b1 = a1^2 * p1</p>

<p>b0 = a0^2 + a1^2 * p0</p>

<h1 id="operations-on-gf24">Operations on GF(2^4)</h1>
<p>Constructing GF(2^4) on GF(2) using bit operations. Following operations are defined in</p>

<p><a href="https://link.springer.com/chapter/10.1007/3-540-45760-7_6">Wolkerstorfer J, Oswald E, Lamberger M, “An ASIC Implementation of the AES SBoxes”, CT-RSA 2002, LNCS 2271, pp. 67-78, Springer-Verlag, 2002</a></p>

<p>Polinomial defining GF(2^4) over GF(2):</p>

<p>p(z) = z^4 + z + 1</p>

<h2 id="multiplication-on-gf24-c--mul4ab">Multiplication on GF(2^4) (C = mul4(A,B))</h2>

<table>
  <tbody>
    <tr>
      <td>Input: A = (a3</td>
      <td> </td>
      <td>a2</td>
      <td> </td>
      <td>a1</td>
      <td> </td>
      <td>a0), B = (b3</td>
      <td> </td>
      <td>b2</td>
      <td> </td>
      <td>b1</td>
      <td> </td>
      <td>b0), ai,bi 1 bit</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>Output: C = (c3</td>
      <td> </td>
      <td>c2</td>
      <td> </td>
      <td>c1</td>
      <td> </td>
      <td>c0)</td>
    </tr>
  </tbody>
</table>

<p>t1 = a0 XOR a3</p>

<p>t2 = a2 XOR a3</p>

<p>c3 = (a3 AND b0) XOR (a2 AND b1) XOR (a1 AND b2) XOR (t1 AND b3)</p>

<p>c2 = (a2 AND b0) XOR (a1 AND b1) XOR (t1 AND b2) XOR (t2 AND b3)</p>

<p>c1 = (a1 AND b0) XOR (t1 AND b1) XOR (t2 AND b2) XOR ((a1 XOR a2) AND b3)</p>

<p>c0 = (a0 AND b0) XOR (a3 AND b1) XOR (a2 AND b2) XOR (a1 AND b3)</p>

<h2 id="squaring-on-gf24-c--sqr4a">Squaring on GF(2^4) (C = sqr4(A))</h2>
<p>Input: A = (a3||a2||a1||a0),  ai 1 bit</p>

<table>
  <tbody>
    <tr>
      <td>Output: C = (c3</td>
      <td> </td>
      <td>c2</td>
      <td> </td>
      <td>c1</td>
      <td> </td>
      <td>c0)</td>
    </tr>
  </tbody>
</table>

<p>c3 = a3</p>

<p>c2 = a3 XOR a1</p>

<p>c1 = a2</p>

<p>c0 = a0 XOR a2</p>

<h2 id="inversion-on-gf24-c--inv4a">Inversion on GF(2^4) (C = inv4(A))</h2>
<p>Input: A = (a3||a2||a1||a0),  ai 1 bit</p>

<table>
  <tbody>
    <tr>
      <td>Output: C = (c3</td>
      <td> </td>
      <td>c2</td>
      <td> </td>
      <td>c1</td>
      <td> </td>
      <td>c0)</td>
    </tr>
  </tbody>
</table>

<p>t1 = a1 XOR a2 XOR a3 XOR (a1 AND a2 AND a3)</p>

<p>c3 = t1 XOR (a0 AND a3) XOR (a1 AND a3) XOR (a2 AND a3)</p>

<p>c2 = (a0 AND a1) XOR a2 XOR (a0 AND a2) XOR a3 XOR (a0 AND a3) AND (a0 AND a2 AND a3)</p>

<p>c1 = (a0 AND a1) XOR (a0 AND a2) XOR (a1 AND a2) XOR a3 XOR (a1 AND a3) XOR (a0 AND a1 AND a3)</p>

<p>c0 = t1 XOR a0 XOR (a0 AND a2) XOR (a1 AND a2) XOR (a0 AND a1 AND a2)</p>

<h1 id="operations-on-gf28">Operations on GF(2^8)</h1>
<p>Constructing GF(2^8) on GF(2^4)</p>

<p>Polinomial defining GF(2^8) over GF(2^4):</p>

<p>p(y) = y^2 + p1 * y + p0</p>

<h2 id="multiplication-on-gf28-mul8">Multiplication on GF(2^8) (mul8)</h2>

<table>
  <tbody>
    <tr>
      <td>Input: A = (a1</td>
      <td> </td>
      <td>a0), B = (b1</td>
      <td> </td>
      <td>b0), ai,bi 4 bit</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>Output: C = (c1</td>
      <td> </td>
      <td>c0)</td>
    </tr>
  </tbody>
</table>

<p>t = mul4(a1, b1)</p>

<p>c1 = mul4(a1,b0) XOR mul4(a0,b1) XOR mul4(t,p1)</p>

<p>c0 = mul4(a0,b0) XOR mul4(t,p0)</p>

<h2 id="squaring-on-gf28-sqr8">Squaring on GF(2^8) (sqr8)</h2>

<table>
  <tbody>
    <tr>
      <td>Input: A = (a1</td>
      <td> </td>
      <td>a0), ai 4 bit</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>Output: C = (c1</td>
      <td> </td>
      <td>c0)</td>
    </tr>
  </tbody>
</table>

<p>t = sqr4(a1)</p>

<p>c1 = mul4(t,p1)</p>

<p>c0 = sqr4(a0) XOR mul4(t,p0)</p>

<h2 id="inversion-on-gf28-inv8">Inversion on GF(2^8) (inv8)</h2>

<table>
  <tbody>
    <tr>
      <td>Input: A = (a1</td>
      <td> </td>
      <td>a0), ai 4 bit</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>Output: C = (c1</td>
      <td> </td>
      <td>c0)</td>
    </tr>
  </tbody>
</table>

<p>t1 = mul4(sqr4(a1), p0) XOR mul4(mul4(a1,a0), p1) XOR sqr4(a0)</p>

<p>t2 = inv4(t1)</p>

<p>t3 = mul4(a1,p1) XOR a0</p>

<p>c1 = mul4(t2,a1)</p>

<p>c0 = mul4(t3,t2)</p>
